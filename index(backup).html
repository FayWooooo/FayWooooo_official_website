<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>FayWooooo - å®˜æ–¹ç¶²ç«™</title>
  <link rel="icon" href="logo.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="faycoin-sync.js" type="module"></script>

  <!-- å­—é«” & åœ–ç¤º -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAw3NxfRft4pke6TUl9gQ4a8P0LEm30zWo",
    authDomain: "faycoin-bb878.firebaseapp.com",
    projectId: "faycoin-bb878",
    storageBucket: "faycoin-bb878.appspot.com",
    messagingSenderId: "665116400856",
    appId: "1:665116400856:web:a263d792c69129400d8bad",
    measurementId: "G-ZSZZD4W1HX"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>


  <style>
    body {
      background-image: linear-gradient(rgb(8, 19, 41), rgb(0, 0, 0));
      background-size: cover;
      background-repeat: no-repeat;
      background-attachment: fixed;
      margin-left: 15%;
      margin-right: 15%;
      font-family: 'Roboto', sans-serif;
      min-height: 100vh;
    }
    @media (max-width: 768px) {
      body{
        margin-left: 5%;
        margin-right: 5%;
      }
    }

    .pro-banner {
      background-color: gold;
      color: black;
      text-align: center;
      padding: 10px;
      font-size: 24px;
      font-weight: normal;
      font-family: "hanwangheiheavy";
    }

    nav {
      border-radius: 30px;
      padding: 3px;
      background: rgba(255, 255, 255, 0.07);
      backdrop-filter: blur(15px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      display: flex;
      margin-top: 20px;
      width: 100%;
    }

    ul {
      display: flex;
      list-style: none;
    }

    li {
      display: flex;
      margin-left: 25px;
    }

    .nav_h2 {
      color: white;
      font-size: 35px;
      display: flex;
      margin-top: 15px;
      margin-bottom: 0;
      font-family: "hanwangheiheavy";
      font-weight: normal;
    }

    h1 {
      color: white;
      font-size: 40px;
      font-family: "hanwangheiheavy";
      font-weight: normal;
      text-align: center;
    }

    .wrapper {
      position: relative;
      font-size: 45px;
      font-family: "hanwangheiheavy";
      color: white;
      width: 30ch;
      height: 1.4em;
      margin-top: 50px;
    }
    .bottom-nav {
      position: fixed;
      bottom: 15px;
      width: 70%;
      height: 70px;
      border-radius: 20px;
      display: flex;
      justify-content: space-around;
      align-items: center;
      background: rgba(255, 255, 255, 0.07);
      backdrop-filter: blur(15px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      pointer-events: auto;
      z-index: 999;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #888;
      font-size: 13px;
      text-decoration: none;
      width: 80px;
      font-family: 'hanwangheiheavy', sans-serif;
    }

    .nav-item i {
      font-size: 20px;
      margin-bottom: 5px;
    }

    .nav-item.active {
      color: white;
      font-size: 25px;
    }

    .channel-intro {
      background-color: white;
      border-radius: 20px;
      border: 5px solid rgb(100, 37, 0);
      width: 298px;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'hanwangheiheavy', sans-serif;
    }

    .intro-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-top: 20px;
    }

    .user-dropdown {
      position: relative;
      cursor: pointer;
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid white;
    }

    .dropdown-menu {
      position: absolute;
      bottom: 55px;
      right: 0;
      background: rgba(0, 0, 0, 0.85);
      border: 1px solid white;
      border-radius: 10px;
      padding: 0;
      display: none;
      font-size: 20px;
      color: white;
      z-index: 999;
      min-width: 180px;
      align-items: center;
      text-align: center;
      padding: 10px;
      gap: 8px;
    }

    .dropdown-menu a {
      color: white;
      text-decoration: none;
      margin-top: 5px;
    }

    #claim-btn {
      background-color: gold;
      border: none;
      padding: 5px 15px;
      border-radius: 10px;
      font-weight: normal;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
    }
    .dropdown-menu {
  display: flex;
  flex-direction: column;
  background: rgba(0, 0, 0, 0.85);
  border: 1px solid white;
  border-radius: 10px;
  padding: 10px 15px;
  gap: 8px;
  font-size: 20px;
  color: white;
  min-width: 200px;
  max-width: 90vw;
  z-index: 999;
  text-align: center;
}

.dropdown-item {
  color: white;
  font-family: 'hanwangheiheavy', sans-serif;
  font-size: 20px;
  padding: 5px 10px;
  text-decoration: none;
  border-radius: 5px;
  background: rgba(255, 255, 255, 0.05);
}

.dropdown-item:hover {
  background: rgba(255, 255, 255, 0.2);
}

.dropdown-menu a.dropdown-item {
  display: block;
}
.dropdown-menu {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  background: rgba(0, 0, 0, 0.85);
  border: 1px solid white;
  border-radius: 10px;
  padding: 10px;
  gap: 10px;
  font-size: 20px;
  color: white;
  text-align: center;
  width: auto;
  min-width: 200px;
  max-width: 90vw;
}

.dropdown-item {
  color: white;
  font-family: 'hanwangheiheavy', sans-serif;
  font-size: 20px;
  font-weight: normal;
  text-decoration: none;
  background: none;      /* âœ… æ‹¿æ‰èƒŒæ™¯ */
  border: none;          /* âœ… æ‹¿æ‰é‚Šæ¡† */
  padding: 0;            /* âœ… æ‹¿æ‰é–“è· */
  margin: 0;
}

.dropdown-item:hover {
  text-decoration: underline; /* å¯é¸ï¼šæ»‘éæ™‚åº•ç·šæ•ˆæœ */
  background: none;
}

.dropdown-menu a.dropdown-item {
  display: inline-block;
}

.email-text {
  font-size: 16px;
  color: rgb(255, 255, 255);
  padding: 0;
}

    .pro-banner {
      background-color: gold;
      color: black;
      text-align: center;
      padding: 10px;
      font-size: 20px;
      font-family: "hanwangheiheavy";
      border-radius: 30px;
    }

    .show {
      display: flex !important;
    }

    .pro-banner button#claim-btn {
      margin-top: 10px;
      padding: 8px 20px;
      font-size: 16px;
      font-weight: bold;
      background-color: gold;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    .video{
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    /* å…¬ä½ˆæ¬„æ¨£å¼ */
    .announcement-section {
      margin: 35px 0;
    }

    .announcement-container {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }

    .announcement-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .announcement-title {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #FFD700;
      font-size: 24px;
      font-family: "hanwangheiheavy";
      margin: 0;
    }

    .refresh-controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn-refresh {
      background: linear-gradient(45deg, #4285f4, #1a73e8);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.3s ease;
      font-family: 'hanwangheiheavy', sans-serif;
    }

    .btn-refresh:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(66, 133, 244, 0.4);
    }

    .btn-refresh:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .announcement-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      overflow: hidden;
    }

    .announcement-table th {
      background: linear-gradient(135deg, #94fbff, #6afff3);
      color: #000;
      padding: 12px 8px;
      text-align: left;
      font-weight: normal;
      font-family: 'hanwangheiheavy', sans-serif;
    }

    .announcement-table td {
      padding: 10px 8px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      color: white;
      vertical-align: top;
    }

    .announcement-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .no-announcements {
      text-align: center;
      color: rgba(255, 255, 255, 0.6);
      padding: 30px;
      font-style: italic;
    }

    .loading-status {
      text-align: center;
      color: rgba(255, 255, 255, 0.8);
      padding: 20px;
      font-style: italic;
    }

    .error-status {
      text-align: center;
      color: #ff4757;
      padding: 20px;
      font-style: italic;
    }

    .status-message {
      margin-top: 10px;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 12px;
      display: none;
    }
    .last-updated {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.6);
      text-align: right;
      margin-top: 10px;
    }

    @media (max-width:768px){
      .bottom-nav {
        left: 5%;
        right: 5%;
        width: 90%;
      }
      
      .announcement-header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .announcement-title {
        font-size: 20px;
        justify-content: center;
      }
      
      .refresh-controls {
        justify-content: center;
      }
      
      .announcement-table {
        font-size: 11px;
      }
      
      .announcement-table th,
      .announcement-table td {
        padding: 8px 4px;
      }
      
      .video iframe {
        width: 90%;
        height: calc(90vw * 9 / 16);
        max-width: none;
      }
    }

    @media (max-width: 768px) {
      .bottom-nav {
        left: 5%;
        right: 5%;
        width: 90%;
      }
      
      .video iframe {
        width: 90%;
        height: calc(90vw * 9 / 16);
        max-width: none;
      }
    }
    .video iframe{
      border-radius: 30px;
      border: solid white 3px;
    }
    
.email-text {
  font-size: 16px;
  color: rgb(255, 255, 255);
  background: none;
  padding: 0;
  margin: 0;
}
#loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(8px);
  z-index: 9999;
  display: flex;
  justify-content: center;
  align-items: center;
}

.loader {
  width: 80px;
  height: 80px;
  position: relative;
}

.loader span {
  width: 16px;
  height: 16px;
  background: gold;
  border-radius: 50%;
  position: absolute;
  animation: pulse 1s infinite ease-in-out;
}

.loader span:nth-child(1) { top: 0; left: 50%; transform: translate(-50%, -50%); animation-delay: 0s;}
.loader span:nth-child(2) { right: 0; top: 50%; transform: translate(50%, -50%); animation-delay: 0.2s;}
.loader span:nth-child(3) { bottom: 0; left: 50%; transform: translate(-50%, 50%); animation-delay: 0.4s;}
.loader span:nth-child(4) { left: 0; top: 50%; transform: translate(-50%, -50%); animation-delay: 0.6s;}

@keyframes pulse {
  0%, 100% { transform: scale(0.8); opacity: 0.6; }
  50% { transform: scale(1.2); opacity: 1; }
}
.dropdown-menu {
  display: none;
  flex-direction: column;
  background: rgba(0, 0, 0, 0.85);
  border: 1px solid white;
  border-radius: 10px;
  padding: 10px 15px;
  gap: 8px;
  font-size: 20px;
  color: white;
  min-width: 200px;
  max-width: 90vw;
  z-index: 999;
  text-align: center;
}

.dropdown-menu.show {
  display: flex !important;
}
.no-scroll {
  overflow: hidden;
  height: 100vh;
}
.site-footer {
  background: rgba(255, 255, 255, 0.07);
  backdrop-filter: blur(12px) saturate(180%);
  border-top: 1px solid rgba(255, 255, 255, 0.15);
  text-align: center;
  padding: 15px;
  color: #fff;
  font-family: 'hanwangheiheavy', sans-serif;
  border-radius: 20px 20px 0 0;
  margin-top: 40px;
  margin-bottom: 15px; /* âœ… èˆ‡åº•éƒ¨å°èˆªé–“éš” */
  box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.4);
}

.site-footer .footer-content {
  max-width: 900px;
  margin: 0 auto;
}

.site-footer p {
  margin: 5px 0;
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
}

.site-footer .footer-links a {
  color: #FFD700;
  text-decoration: none;
  margin: 0 8px;
  font-size: 14px;
}

.site-footer .footer-links a:hover {
  text-decoration: underline;
  color: #fff;
}

@media (max-width: 768px) {
  .site-footer {
    font-size: 13px;
    padding: 10px;
  }
}
.site-footer {
  background: rgba(255, 255, 255, 0.07);
  backdrop-filter: blur(12px) saturate(180%);
  border-top: 1px solid rgba(255, 255, 255, 0.15);
  text-align: center;
  padding: 15px;
  color: #fff;
  font-family: 'hanwangheiheavy', sans-serif;
  border-radius: 20px;
  margin-top: 40px;
  margin-bottom: 90px; /* âœ… é ç•™ bottom-nav é«˜åº¦é¿å…è¢«è“‹ä½ */
  box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.4);
}

.site-footer .footer-links a {
  color: #FFD700;
  margin: 0 8px;
  text-decoration: none;
}

.site-footer .footer-links a:hover {
  text-decoration: underline;
  color: #fff;
}
@media (max-width:768px){
  .subscribe-hint{
    display: none;
  }
}
  </style>
</head>
<body>
  <!-- Pro Banner å€ -->
  <div id="pro-banner-container"></div>
  <!-- æœƒå“¡ Banner æç¤ºå°ˆç”¨å®¹å™¨ï¼ˆæ”¹ ID åç¨±é¿å…æ’åï¼‰ -->
  <div id="membership-banner-container"></div>
  <!-- é€²å…¥ç¶²é çš„æ¨¡ç³Šæ•ˆæœ -->
  <div id="loading-overlay">
  <div class="loader">
    <span></span><span></span><span></span><span></span>
  </div>
</div>

  <!-- é ‚éƒ¨å°è¦½åˆ— -->
  <nav>
    <ul>
      <li><img src="logo.ico" style="width: 70px;"></li>
      <li><h2 class="nav_h2">FayWooooo å®˜æ–¹ç¶²ç«™</h2></li>
    </ul>
  </nav>

  <!-- å…§å®¹å€ -->
  <div class="main">
    <center><div>
      <h1 class="subscribe-hint" style="font-size: 70px;display:inline-block;">è¨‚é–±äº†æ²’?</h1>
      <h1 class="subscribe-hint" style="margin-top: -35px;display:inline-block;">è¶•å¿«è¨‚é–±èµ·ä¾†!!!</h1>
    </div></center>
    <!-- å…¬ä½ˆæ¬„å€åŸŸ -->
    <hr style="margin-top:35px"> 
    <h1>ğŸ“¢ æœ€æ–°å…¬å‘Š ğŸ“¢</h1>
    <div class="announcement-section">    
        <div id="statusMessage" class="status-message"></div>
        
        <div style="overflow-x: auto;">
          <table class="announcement-table" id="announcementTable">
            <thead>
              <tr>
                <th width="12%" style="font-size: 18px;font-weight:normal">æ—¥æœŸ</th>
                <th width="25%" style="font-size: 18px;font-weight:normal">æ¨™é¡Œ</th>
                <th width="63%" style="font-size: 18px;font-weight:normal">å…§å®¹</th>
              </tr>
            </thead>
            <tbody id="announcementBody" style="font-size: 18px;">
              <tr>
                <td colspan="5" class="loading-status">
                  <i class="fas fa-spinner fa-spin"></i> 
                  æ­£åœ¨è¼‰å…¥å…¬å‘Šè³‡æ–™...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="last-updated" id="lastUpdated"></div>
      </div>
    </div>
    
    <hr style="margin-top:35px">
    <h1 style="text-align: center;">âœ é »é“ç°¡ä»‹ âœ</h1>
    <div class="intro-container">
      <div class="channel-intro">
        <p>å—¨å„ä½~ æˆ‘æ˜¯FayWoooooï¼Œä¸€å€‹å°ä¸»Boã€‚<br>é¡å‹: éŠæˆ²ã€æç¬‘ã€æ•™å­¸<br>ä¸»è¦æ‹æ”éŠæˆ²: è’é‡äº‚é¬¥</p>
      </div>
      <div class="channel-intro">
        <p>âœ”ï¸50è¨‚é–±âœ”ï¸200è¨‚é–± âœ”ï¸350è¨‚é–± âœ”ï¸500è¨‚é–± âœ”ï¸700 âœ”ï¸850 âœ”ï¸1000 âŒ1500<br>2025/7/13é¦–éƒ¨è¶…é10è¬è§€çœ‹çŸ­ç‰‡</p>
      </div>
      <div class="channel-intro">
        <p>è’é‡äº‚é¬¥åŠ å¥½å‹<br>å¤§å¸³ç›ƒæ•¸:å…©è¬å¤š ID:YTFayWooooo<br>äºŒå¸³ç›ƒæ•¸:ä¸€è¬å¤š ID:FayWooooo</p>
        <div style="display: flex">
          <a href="https://link.brawlstars.com/invite/friend/cnt?tag=LG2P80G20&token=ptfnj8az" target="_blank">åŠ å¤§å¸³å¥½å‹</a>
          <a href="https://link.brawlstars.com/invite/friend/cnt?tag=JGV8LY02V&token=ptfnj8az" target="_blank" style="margin-left:25px">åŠ äºŒå¸³å¥½å‹</a>
        </div>
      </div>
      <div class="channel-intro">
        <p>åˆä½œé‚€ç´„:<br>Email: faywooooo@gmail.com<br>LINE: faywooooo<br>Discord: faywooooo_bs</p>
      </div>
    </div>
    <hr style="margin-top:35px">
    <h1 style="text-align: center;">ğŸï¸ ç†±é–€å½±ç‰‡ ğŸï¸</h1>
    <div class="video">
      <iframe width="648" height="387" src="https://www.youtube.com/embed/dAhDO5QcQnE" allowfullscreen></iframe>
      <iframe width="648" height="387" src="https://www.youtube.com/embed/yPMO1tqtMco" allowfullscreen></iframe>
      <iframe width="648" height="387" src="https://www.youtube.com/embed/7rYQqpOXqVs" allowfullscreen></iframe>
      <iframe width="648" height="387" src="https://www.youtube.com/embed/Vbgkd2pcJV4" allowfullscreen></iframe>
    </div>
    <hr style="margin-top:35px">
    <h1 style="text-align: center;">â¢ æ’­æ”¾æ¸…å–® â¢</h1>
    <div class="video">
      <iframe width="648" height="387" src="https://www.youtube.com/embed/videoseries?list=PLesAf0sB4MlEUNTCkvYszJvWl3NIXH3s7" allowfullscreen></iframe>
      <iframe width="648" height="387" src="https://www.youtube.com/embed/videoseries?list=PLesAf0sB4MlHA05zWd4TnvzKm1f4BgVk8" allowfullscreen></iframe>
    </div>
    
  </div>
<!-- Footer åœ¨ bottom-nav å‰ -->
<footer class="site-footer">
  <div class="footer-content">
    <p>Â© 2025 FayWooooo. All Rights Reserved.</p>
    <div class="footer-links">
      <a href="about_us.html">é—œæ–¼æˆ‘å€‘</a> |
      <a href="https://mail.google.com/mail/?view=cm&fs=1&to=faywooooo@gmail.com&su=æä¾›åé¥‹å»ºè­°&body=æ‚¨å¥½ï¼Œæˆ‘æƒ³å°æœ¬ç¶²ç«™æå‡ºå»ºè­°" target="_blank">è¯çµ¡ä¿¡ç®±</a> |
      <a href="https://sites.google.com/view/faywooooo-related-platforms" target="_blank">ç›¸é—œå¹³å°</a>
    </div>
  </div>
</footer>

<div class="bottom-nav">
  <a style="-webkit-text-stroke: 1.5px black;" href="index.html" class="nav-item active"><i class="fas fa-home"></i>é¦–é </a>
  <a style="-webkit-text-stroke: 1.5px black;" href="https://sites.google.com/view/faywooooo-related-platforms" target="_blank" class="nav-item active"><i class="fab fa-youtube"></i>ç›¸é—œ<br>å¹³å°</a>
  <a style="-webkit-text-stroke: 1.5px black;" href="about_us.html" class="nav-item active"><i class="fas fa-store"></i>é—œæ–¼<br>æˆ‘å€‘</a>
  <a style="-webkit-text-stroke: 1.5px black;" href="https://mail.google.com/mail/?view=cm&fs=1&to=faywooooo@gmail.com&su=æ–‡å­—å®¢æœ&body=æ‚¨å¥½ï¼Œæˆ‘æœ‰å•é¡Œæƒ³å•:" class="nav-item active" target="_blank"><i class="fas fa-store"></i>å®˜æ–¹<br>å®¢æœ</a>
  <a style="-webkit-text-stroke: 1.5px black;" href="login.html" class="nav-item active" id="login-item">
    <i class="fab fa-discord"></i>æœƒå“¡<br>ç™»å…¥
  </a>
</div>



  <!-- âœ… JSï¼šç™»å…¥ç‹€æ…‹è™•ç†èˆ‡å…¬ä½ˆæ¬„åŠŸèƒ½ -->
<script>
  // ====== å…¨åŸŸè®Šé‡ ======
  let currentUserEmail = null;
  let currentUserCoinBalance = 0;

  // ====== Firebase ç›¸é—œå‡½æ•¸ ======
  
  // å¾ Firebase ç²å–ä½¿ç”¨è€… Fay å¹£é¤˜é¡
  async function getUserCoinsFromFirebase(userEmail) {
    try {
      const snapshot = await db.collection('userLoginRewards')
        .where('userEmail', '==', userEmail)
        .limit(1)
        .get();
        
      if (!snapshot.empty) {
        const doc = snapshot.docs[0];
        return doc.data().coins || 0;
      }
      return 0;
    } catch (error) {
      console.error("âŒ ç„¡æ³•å–å¾— Fay å¹£é¤˜é¡", error);
      return 0;
    }
  }

  // æ›´æ–° Firebase ä¸­çš„ Fay å¹£é¤˜é¡
  async function updateUserCoinsInFirebase(userEmail, newBalance) {
    try {
      const snapshot = await db.collection('userLoginRewards')
        .where('userEmail', '==', userEmail)
        .limit(1)
        .get();
        
      if (!snapshot.empty) {
        const doc = snapshot.docs[0];
        await doc.ref.update({ coins: newBalance });
      } else {
        // å¦‚æœç”¨æˆ¶ä¸å­˜åœ¨ï¼Œå‰µå»ºæ–°è¨˜éŒ„
        await db.collection('userLoginRewards').add({
          userEmail: userEmail,
          coins: newBalance,
          lastLogin: firebase.firestore.FieldValue.serverTimestamp()
        });
      }
      return true;
    } catch (error) {
      console.error("âŒ ç„¡æ³•æ›´æ–° Fay å¹£é¤˜é¡", error);
      return false;
    }
  }

  // æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦å·²é ˜å–å…¥æœƒç¦®
  async function hasClaimedWelcomeGiftFromFirebase(userEmail) {
    try {
      const snapshot = await db.collection('userLoginRewards')
        .where('userEmail', '==', userEmail)
        .where('hasClaimedWelcome', '==', true)
        .limit(1)
        .get();
      return !snapshot.empty;
    } catch (error) {
      console.error("âŒ ç„¡æ³•æª¢æŸ¥å…¥æœƒç¦®ç‹€æ…‹", error);
      return false;
    }
  }

  // æ¨™è¨˜ç”¨æˆ¶å·²é ˜å–å…¥æœƒç¦®
  async function markWelcomeGiftClaimedInFirebase(userEmail) {
    try {
      const snapshot = await db.collection('userLoginRewards')
        .where('userEmail', '==', userEmail)
        .limit(1)
        .get();
        
      if (!snapshot.empty) {
        const doc = snapshot.docs[0];
        await doc.ref.update({ 
          hasClaimedWelcome: true,
          coins: firebase.firestore.FieldValue.increment(100)
        });
      } else {
        await db.collection('userLoginRewards').add({
          userEmail: userEmail,
          coins: 100,
          hasClaimedWelcome: true,
          lastLogin: firebase.firestore.FieldValue.serverTimestamp()
        });
      }
      return true;
    } catch (error) {
      console.error("âŒ ç„¡æ³•æ¨™è¨˜å…¥æœƒç¦®", error);
      return false;
    }
  }

  // ====== ç™»å…¥èˆ‡æœƒå“¡åŠŸèƒ½ ======

  function showPreLoginBanner() {
    document.getElementById('pro-banner-container').innerHTML =
      '<div class="pro-banner">ğŸ”’ ç™»å…¥æœƒå“¡ä»¥ç²å– 100 Fayå¹£</div>';
  }

  async function showProBannerWithClaim(userEmail) {
  // âœ… æ–°å¢è¨˜éŒ„æ©Ÿåˆ¶ï¼šæ›¾ç¶“é ˜éå°±ä¸å†æŸ¥è©¢
  const claimedCacheKey = `hasClaimedWelcome:${userEmail}`;
  const alreadyKnown = localStorage.getItem(claimedCacheKey) === 'true';
  if (alreadyKnown) {
    document.getElementById('pro-banner-container').innerHTML = '';
    return;
  }

  const hasClaimedGift = await hasClaimedWelcomeGiftFromFirebase(userEmail);
  if (hasClaimedGift) {
    localStorage.setItem(claimedCacheKey, 'true'); // âœ… è¨˜éŒ„èµ·ä¾†
    document.getElementById('pro-banner-container').innerHTML = '';
    return;
  }

  document.getElementById('pro-banner-container').innerHTML = `
    <div class="pro-banner">
      âœ¨ æ­¡è¿åŠ å…¥æˆ‘å€‘çš„æœƒå“¡ï¼Œè«‹é»æ“ŠæŒ‰éˆ•ç²å–å…¥æœƒç¦® âœ¨<br>
      <button id="claim-btn">é»æˆ‘é ˜å–100Fayå¹£</button>
    </div>`;

  const btn = document.getElementById('claim-btn');
  if (btn) {
    btn.onclick = async function () {
      btn.disabled = true;
      btn.innerText = 'é ˜å–ä¸­...';

      const success = await markWelcomeGiftClaimedInFirebase(userEmail);
      if (success) {
        alert('ğŸ‰ æ­å–œä½ ç²å¾—äº† 100 Fayå¹£ï¼');
        currentUserCoinBalance = await getUserCoinsFromFirebase(userEmail);
        localStorage.setItem('fayCoinBalance', currentUserCoinBalance.toString());

        // âœ… è¨˜éŒ„é ˜é
        localStorage.setItem(claimedCacheKey, 'true');

        document.getElementById('pro-banner-container').innerHTML = '';
        updateAllFayCoinDisplays();
      } else {
        alert('âŒ é ˜å–å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
        btn.disabled = false;
        btn.innerText = 'é»æˆ‘é ˜å–100Fayå¹£'
}}}}

  async function showUserMenu(email) {
    const loginItem = document.getElementById('login-item');
    const name = localStorage.getItem('userName') || 'è¨ªå®¢';
    const avatarUrl = localStorage.getItem('userPhotoURL') ||
      `https://www.gravatar.com/avatar/${md5(email.trim().toLowerCase())}?s=40&d=identicon`;

    // å¾ Firebase ç²å–æœ€æ–° Fay å¹£é¤˜é¡
    currentUserCoinBalance = await getUserCoinsFromFirebase(email);
    localStorage.setItem('fayCoinBalance', currentUserCoinBalance.toString());

    if (loginItem) {
      loginItem.outerHTML = `
        <div class="nav-item user-dropdown" id="user-dropdown">
          <img src="${avatarUrl}" alt="é ­åƒ" class="avatar" id="avatar-img" />
          <div class="dropdown-menu" id="dropdown-menu">
            <div class="dropdown-item"><strong>${name}</strong></div>
            <div class="dropdown-item email-text">${email}</div>
            <a class="dropdown-item" href="exchange.html">
              Fayå¹£ï¼š<span id="coin-count" style="color: gold;">${currentUserCoinBalance}</span><br> âœ å…Œæ›
            </a>
            <a class="dropdown-item" href="earn.html">ä»»å‹™</a>
            <a class="dropdown-item" href="setting.html">è¨­å®š</a>
            <a class="dropdown-item" href="#" id="logout-link">ç™»å‡º</a>
          </div>
        </div>`;
    }
    
    setTimeout(() => {
      const avatar = document.getElementById('avatar-img');
      const menu = document.getElementById('dropdown-menu');
      const logoutLink = document.getElementById('logout-link');
      
      if (!avatar || !menu) return;
      
      avatar.addEventListener('click', (e) => {
        e.stopPropagation();
        menu.classList.toggle('show');
      });
      
      document.addEventListener('click', (e) => {
        if (!avatar.contains(e.target) && !menu.contains(e.target)) {
          menu.classList.remove('show');
        }
      });
      
      if (logoutLink) {
        logoutLink.addEventListener('click', (e) => {
          e.preventDefault();
          logout();
        });
      }
    }, 100);
  }

  function updateAllFayCoinDisplays() {
    const coinDisplay = document.getElementById('coin-count');
    if (coinDisplay) {
      coinDisplay.innerText = currentUserCoinBalance;
    }
  }

  function logout() {
    // æ¸…é™¤æ‰€æœ‰ç™»å…¥ç‹€æ…‹
    localStorage.removeItem('isLoggedIn');
    localStorage.removeItem('userEmail');
    localStorage.removeItem('userName');
    localStorage.removeItem('userPhotoURL');
    localStorage.removeItem('fayCoinBalance');
    localStorage.removeItem('justLoggedIn');
    
    // é‡è¼‰é é¢
    window.location.reload();
  }

  // ====== å…¬å‘ŠåŠŸèƒ½ ======

  const GOOGLE_SHEETS_CSV_URL = 'https://docs.google.com/spreadsheets/d/1kX-pQsTBIk-_gdd89oIquIaLIeTlNbvZnQ9KzxVqeEs/gviz/tq?tqx=out:csv';

  let announcements = [];
  let isLoading = false;

  async function loadAnnouncementsFromGoogleSheets() {
    if (isLoading) return;

    isLoading = true;
    const refreshBtn = document.getElementById('refreshBtn');
    const statusMessage = document.getElementById('statusMessage');

    if (refreshBtn) {
      refreshBtn.disabled = true;
      refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è¼‰å…¥ä¸­...';
    }

    try {
      const proxyUrl = 'https://corsproxy.io/?';
      const response = await fetch(proxyUrl + encodeURIComponent(GOOGLE_SHEETS_CSV_URL));
      if (!response.ok) throw new Error('ç„¡æ³•è¼‰å…¥å…¬å‘Šè³‡æ–™');
      const csvText = await response.text();
      announcements = parseCSVToAnnouncements(csvText);
      showStatusMessage('å…¬å‘Šè³‡æ–™æ›´æ–°æˆåŠŸï¼', 'success');
      renderAnnouncements();
      updateLastUpdatedTime();
    } catch (error) {
      console.error('è¼‰å…¥å…¬å‘Šå¤±æ•—:', error);
      showStatusMessage('è¼‰å…¥å…¬å‘Šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦', 'error');
      showErrorState();
    } finally {
      isLoading = false;
      if (refreshBtn) {
        refreshBtn.disabled = false;
        refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i> é‡æ–°æ•´ç†';
      }
    }
  }

  function parseCSVToAnnouncements(csvText) {
    const lines = csvText.split('\n');
    const announcements = [];

    for (let i = 1; i < lines.length; i++) {
      const line = lines[i].trim();
      if (!line) continue;
      const columns = parseCSVLine(line);
      if (columns.length >= 3 && columns[0] && columns[1]) {
        announcements.push({
          date: columns[0],
          title: columns[1],
          content: columns[2] || '',
        });
      }
    }

    return announcements;
  }

  function parseCSVLine(line) {
    const result = [];
    let current = '';
    let inQuotes = false;

    for (let i = 0; i < line.length; i++) {
      const char = line[i];
      if (char === '"') {
        inQuotes = !inQuotes;
      } else if (char === ',' && !inQuotes) {
        result.push(current.trim());
        current = '';
      } else {
        current += char;
      }
    }

    result.push(current.trim());
    return result;
  }

  function renderAnnouncements() {
    const tbody = document.getElementById('announcementBody');

    if (announcements.length === 0) {
      tbody.innerHTML = `
        <tr>
          <td colspan="5" class="no-announcements">
            <i class="fas fa-info-circle"></i> 
            ç›®å‰æ²’æœ‰å…¬å‘Šè³‡æ–™
          </td>
        </tr>
      `;
      return;
    }

    tbody.innerHTML = '';
    announcements.forEach(announcement => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${announcement.date}</td>
        <td>${announcement.title}</td>
        <td>${announcement.content}</td>
      `;
      tbody.appendChild(row);
    });
  }

  function showStatusMessage(message, type = 'info') {
    const statusDiv = document.getElementById('statusMessage');
    statusDiv.className = `status-message status-${type}`;
    statusDiv.textContent = message;
    statusDiv.style.display = 'block';
    setTimeout(() => {
      statusDiv.style.display = 'none';
    }, 3000);
  }

  function updateLastUpdatedTime() {
    const lastUpdatedDiv = document.getElementById('lastUpdated');
    const now = new Date();
    const timeString = now.toLocaleString('zh-TW', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit'
    });
    lastUpdatedDiv.textContent = `æœ€å¾Œæ›´æ–°ï¼š${timeString}`;
  }

  function showErrorState() {
    const tbody = document.getElementById('announcementBody');
    tbody.innerHTML = `
      <tr>
        <td colspan="5" class="error-status">
          <i class="fas fa-exclamation-triangle"></i> 
          è¼‰å…¥å…¬å‘Šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦
        </td>
      </tr>
    `;
  }

  // ====== é é¢è¼‰å…¥æ•ˆæœ ======

  function disableUserInteraction() {
    document.body.classList.add('no-scroll');
    document.addEventListener('wheel', preventDefault, { passive: false });
    document.addEventListener('touchmove', preventDefault, { passive: false });
    document.addEventListener('keydown', preventKeyScroll, { passive: false });
  }

  function enableUserInteraction() {
    document.body.classList.remove('no-scroll');
    document.removeEventListener('wheel', preventDefault);
    document.removeEventListener('touchmove', preventDefault);
    document.removeEventListener('keydown', preventKeyScroll);
  }

  function preventDefault(e) {
    e.preventDefault();
  }

  function preventKeyScroll(e) {
    if ([32, 37, 38, 39, 40].includes(e.keyCode)) {
      e.preventDefault();
    }
  }

  // ====== äº‹ä»¶ç›£è½å™¨ ======

  // ç›£è½ä¾†è‡ªç™»å…¥é é¢çš„è¨Šæ¯
  // æ¥æ”¶å¾ earn.html å›å‚³çš„çå‹µé€šçŸ¥
window.addEventListener('message', async function(event) {
  // å¯é¸ï¼šæª¢æŸ¥ä¾†æºå®‰å…¨æ€§ if needed
  if (event.data?.type === 'fay-reward-claimed') {
    const { day, amount } = event.data;
    alert(`ğŸ å·²æˆåŠŸé ˜å–ç¬¬ ${day} å¤©çå‹µï¼š${amount} Fayå¹£`);

    // é‡æ–°ç²å– Fay å¹£ä¸¦æ›´æ–°ç•«é¢
    const email = localStorage.getItem('userEmail');
    if (email) {
      const updated = await getUserCoinsFromFirebase(email);
      currentUserCoinBalance = updated;
      localStorage.setItem('fayCoinBalance', updated.toString());
      updateAllFayCoinDisplays();
    }
  }
});



  // ç›£è½ Fayå¹£è®ŠåŒ–äº‹ä»¶
  window.addEventListener('fayCoinChanged', function(event) {
    if (event.detail && event.detail.newBalance !== undefined) {
      currentUserCoinBalance = event.detail.newBalance;
      updateAllFayCoinDisplays();
    }
  });

  // ç›£è½ localStorage è®ŠåŒ–ï¼ˆè·¨é ç±¤åŒæ­¥ï¼‰
  window.addEventListener('storage', function(event) {
    if (event.key === 'fayCoinBalance') {
      currentUserCoinBalance = parseInt(event.newValue || '0', 10);
      updateAllFayCoinDisplays();
    }
  });

  // ç›£è½é é¢å¯è¦‹æ€§è®ŠåŒ–ï¼ˆé‡æ–°ç²å–æœ€æ–°æ•¸æ“šï¼‰
  document.addEventListener('visibilitychange', async function() {
    if (document.visibilityState === 'visible' && currentUserEmail) {
      currentUserCoinBalance = await getUserCoinsFromFirebase(currentUserEmail);
      localStorage.setItem('fayCoinBalance', currentUserCoinBalance.toString());
      updateAllFayCoinDisplays();
    }
  });

  // ====== åˆå§‹åŒ– ======

  window.addEventListener('DOMContentLoaded', () => {
    disableUserInteraction(); // é é¢è¼‰å…¥æ™‚ç¦æ­¢æ“ä½œ
  });

  window.addEventListener('load', () => {
    setTimeout(() => {
      const overlay = document.getElementById('loading-overlay');
      if (overlay) overlay.style.display = 'none';
      enableUserInteraction();
    }, 600);
  });

  window.onload = async function () {
    // é¡¯ç¤ºç™»å…¥æˆåŠŸæç¤º
    if (localStorage.getItem('justLoggedIn') === 'true') {
      alert('ğŸ‰ æ­¡è¿ç™»å…¥æˆåŠŸï¼');
      localStorage.removeItem('justLoggedIn');
    }

    // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
    if (localStorage.getItem('isLoggedIn') === 'true') {
      const email = localStorage.getItem('userEmail') || 'guest@example.com';
      currentUserEmail = email;

      try {
        // å¾ Firebase åŒæ­¥æœ€æ–° Fay å¹£é¤˜é¡
        currentUserCoinBalance = await getUserCoinsFromFirebase(email);
        localStorage.setItem('fayCoinBalance', currentUserCoinBalance.toString());

        // é¡¯ç¤ºç”¨æˆ¶ç•Œé¢
        await showProBannerWithClaim(email);
        await showUserMenu(email);
      } catch (error) {
        console.error("âŒ åˆå§‹åŒ–ç”¨æˆ¶ç‹€æ…‹å¤±æ•—", error);
        // å³ä½¿ Firebase å¤±æ•—ä¹Ÿè¦é¡¯ç¤ºåŸºæœ¬ UI
        await showUserMenu(email);
      }
    } else {
      showPreLoginBanner();
    }

    // è¼‰å…¥å…¬å‘Š
    loadAnnouncementsFromGoogleSheets();
  };
// ç¾åœ¨ä»ç„¶å¯ä»¥é€™æ¨£ç”¨ï¼Œæœƒè‡ªå‹•åŒæ­¥
addFayCoins(15);
const email = localStorage.getItem('userEmail');
if (email) {
  const db = firebase.firestore();
  db.collection('userLoginRewards')
    .where('userEmail', '==', email)
    .get()
    .then(snapshot => {
      if (!snapshot.empty) {
        snapshot.forEach(doc => {
          db.collection('userLoginRewards').doc(doc.id).update({ coins: updated });
        });
      }
    });
}
window.fayCoinManager.addListener((newBalance) => {
  document.getElementById('coin-balance').textContent = newBalance;
});

</script>
<div id="coin-display">Fayå¹£ï¼š<span id="coin-balance">0</span></div>
<script type="module">
import './faycoin-sync.js';

window.fayCoinManager.addListener((newBal)=>{
  const display = document.getElementById('coin-count');
  if(display) display.textContent = newBal;
});
window.fayCoinManager.updateBalance(æœ€æ–°é¤˜é¡);
// ====== ä¿®å¾© Fayå¹£å³æ™‚æ›´æ–° ======

// ç­‰å¾… fayCoinManager åˆå§‹åŒ–å®Œæˆ
function waitForFayCoinManager() {
  return new Promise((resolve) => {
    if (window.fayCoinManager) {
      resolve();
    } else {
      setTimeout(() => waitForFayCoinManager().then(resolve), 100);
    }
  });
}

// è¨­ç½® Fayå¹£å³æ™‚æ›´æ–°ç›£è½å™¨
async function setupFayCoinSync() {
  await waitForFayCoinManager();
  
  // æ¸…é™¤æ‰€æœ‰èˆŠçš„ç›£è½å™¨ï¼ˆé¿å…é‡è¤‡ï¼‰
  if (window.fayCoinSyncSetup) return;
  window.fayCoinSyncSetup = true;
  
  // æ·»åŠ å³æ™‚æ›´æ–°ç›£è½å™¨
  window.fayCoinManager.addListener((newBalance, oldBalance) => {
    console.log(`ğŸ’° Fayå¹£æ›´æ–°: ${oldBalance} â†’ ${newBalance}`);
    
    // æ›´æ–°æ‰€æœ‰é¡¯ç¤º Fayå¹£çš„å…ƒç´ 
    const coinDisplays = document.querySelectorAll('#coin-count, #coin-balance, .fay-coin-display');
    coinDisplays.forEach(element => {
      if (element) {
        element.textContent = newBalance;
        element.style.color = 'gold';
      }
    });
    
    // æ›´æ–°å…¨åŸŸè®Šé‡
    currentUserCoinBalance = newBalance;
  });
  
  console.log('âœ… Fayå¹£å³æ™‚åŒæ­¥ç›£è½å™¨å·²è¨­ç½®');
}

// ä¿®æ”¹ç¾æœ‰çš„ showUserMenu å‡½æ•¸ä¸­çš„ Fayå¹£é¡¯ç¤ºéƒ¨åˆ†
async function showUserMenu(email) {
  const loginItem = document.getElementById('login-item');
  const name = localStorage.getItem('userName') || 'è¨ªå®¢';
  const avatarUrl = localStorage.getItem('userPhotoURL') ||
    `https://www.gravatar.com/avatar/${md5(email.trim().toLowerCase())}?s=40&d=identicon`;

  // âœ… ä½¿ç”¨ fayCoinManager ç²å–é¤˜é¡
  await waitForFayCoinManager();
  currentUserCoinBalance = window.fayCoinManager.getBalance();

  // âœ… ä½¿ç”¨èˆ‡ exchange.html ç›¸åŒçš„æ–¹å¼è¼‰å…¥é¤˜é¡
  try {
    const snapshot = await db.collection('userLoginRewards')
      .where('userEmail', '==', email)
      .get();
    
    let coins = 0;
    if (!snapshot.empty) {
      coins = snapshot.docs[0].data().coins || 0;
    }
    
    // åŒæ­¥æ›´æ–°
    currentUserCoinBalance = coins;
    localStorage.setItem('fayCoinBalance', coins.toString());
    
  } catch (error) {
    console.error("âŒ è¼‰å…¥é¤˜é¡å¤±æ•—", error);
    currentUserCoinBalance = parseInt(localStorage.getItem('fayCoinBalance') || '0');
  }

  // é¡¯ç¤ºç”¨æˆ¶é¸å–®ï¼ˆåŒ…å«æœ€æ–°é¤˜é¡ï¼‰
  if (loginItem) {
    loginItem.outerHTML = `
      <div class="nav-item user-dropdown" id="user-dropdown">
        <img src="${avatarUrl}" alt="é ­åƒ" class="avatar" id="avatar-img" />
        <div class="dropdown-menu" id="dropdown-menu">
          <div class="dropdown-item"><strong>${name}</strong></div>
          <div class="dropdown-item email-text">${email}</div>
          <a class="dropdown-item" href="exchange.html">
            Fayå¹£ï¼š<span id="coin-count" style="color: gold;">${currentUserCoinBalance}</span><br> âœ å…Œæ›
          </a>
          <a class="dropdown-item" href="earn.html">ä»»å‹™</a>
          <a class="dropdown-item" href="setting.html">è¨­å®š</a>
          <a class="dropdown-item" href="#" id="logout-link">ç™»å‡º</a>
        </div>
      </div>`;
  }
}

// ä¿®æ”¹ window.onload å‡½æ•¸
window.onload = async function () {
  // é¡¯ç¤ºç™»å…¥æˆåŠŸæç¤º
  if (localStorage.getItem('justLoggedIn') === 'true') {
    alert('ğŸ‰ æ­¡è¿ç™»å…¥æˆåŠŸï¼');
    localStorage.removeItem('justLoggedIn');
  }

  // âœ… å…ˆè¨­ç½® Fayå¹£åŒæ­¥
  await setupFayCoinSync();

  // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
  if (localStorage.getItem('isLoggedIn') === 'true') {
    const email = localStorage.getItem('userEmail') || 'guest@example.com';
    currentUserEmail = email;

    try {
      // âœ… ä½¿ç”¨ fayCoinManager åŒæ­¥ Firebase é¤˜é¡
      await waitForFayCoinManager();
      const firebaseBalance = await getUserCoinsFromFirebase(email);
      window.fayCoinManager.updateBalance(firebaseBalance);

      // é¡¯ç¤ºç”¨æˆ¶ç•Œé¢
      await showProBannerWithClaim(email);
      await showUserMenu(email);
    } catch (error) {
      console.error("âŒ åˆå§‹åŒ–ç”¨æˆ¶ç‹€æ…‹å¤±æ•—", error);
      await showUserMenu(email);
    }
  } else {
    showPreLoginBanner();
  }

  // è¼‰å…¥å…¬å‘Š
  loadAnnouncementsFromGoogleSheets();
};

// âœ… ç§»é™¤æ‰€æœ‰é‡è¤‡çš„ç›£è½å™¨ä»£ç¢¼å’Œæ¸¬è©¦ä»£ç¢¼
// âœ… æ·»åŠ åˆ° window.onload æœ€å¾Œ
window.addEventListener('fayCoinChanged', (event) => {
  if (event.detail && event.detail.newBalance !== undefined) {
    currentUserCoinBalance = event.detail.newBalance;
    const coinDisplay = document.getElementById('coin-count');
    if (coinDisplay) {
      coinDisplay.textContent = currentUserCoinBalance;
    }
  }
});
</script>

<script>
const key = `forceReload:${location.pathname.split('/').pop()}`;
const lastReload = localStorage.getItem(key);
if (lastReload) {
  localStorage.removeItem(key);
  location.reload();
}
</script>
const reloadKey = `forceReload:${location.pathname.split('/').pop()}`;
const reloadValue = localStorage.getItem(reloadKey);
if (reloadValue) {
  localStorage.removeItem(reloadKey);
  location.reload();
}

</body>
</html>